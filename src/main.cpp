#include <iostream>

#include "protodec.h"

int main(int argc, char **argv)
{
	uint8_t data[] = {8, 255, 255, 255, 255, 255, 255, 255, 255, 255, 1, 17, 0, 0, 0, 0, 0, 64, 143, 64, 26, 11, 116, 101, 115, 116, 32, 115, 116, 114, 105, 110, 103, 37, 111, 18, 131, 58, 42, 34, 8, 100, 17, 0, 0, 0, 0, 0, 0, 0, 0, 26, 16, 116, 101, 115, 116, 32, 115, 117, 98, 32, 109, 101, 115, 115, 97, 103, 101, 37, 0, 0, 128, 63, 50, 34, 253, 255, 255, 255, 255, 255, 255, 255, 255, 1, 254, 255, 255, 255, 255, 255, 255, 255, 255, 1, 255, 255, 255, 255, 255, 255, 255, 255, 255, 1, 0, 1, 2, 3, 58, 24, 0, 0, 0, 0, 0, 0, 240, 191, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 240, 63, 66, 6, 116, 101, 115, 116, 32, 49, 66, 6, 116, 101, 115, 116, 32, 50, 74, 12, 0, 0, 128, 191, 0, 0, 0, 0, 0, 0, 128, 63, 82, 24, 8, 1, 17, 0, 0, 0, 0, 0, 0, 240, 63, 26, 6, 116, 101, 115, 116, 32, 49, 37, 0, 0, 128, 63, 82, 24, 8, 2, 17, 0, 0, 0, 0, 0, 0, 0, 64, 26, 6, 116, 101, 115, 116, 32, 50, 37, 0, 0, 0, 64, 248, 255, 255, 255, 15, 255, 255, 255, 255, 255, 255, 255, 255, 255, 1};

	Buffer buffer;
	buffer.start = data;
	buffer.end = data + sizeof(data);

	Field field = decodeProtobuf(buffer, true);
	toJson(&field, std::cout, true);

	return 0;
}